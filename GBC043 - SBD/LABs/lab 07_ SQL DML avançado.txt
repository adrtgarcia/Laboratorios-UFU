LABORATÓRIO SBD - Maria Camila
 
Matheus Fiod Saliba - 12221BCC024
Cauã de Paula Dias - 12211BCC045
Amanda Duarte Garcia - 12221BCC031
Marcos Gabriel Moreira Fonseca - 12221BCC043


1)
SELECT MAX(vr_bem_candidato) AS maximo,MIN(vr_bem_candidato) AS minimo
FROM candidato can, bem_candidato bem
WHERE can.sq_candidato = bem.sq_candidato AND
can.sg_uf = 'MG'

2)
SELECT nm_candidato,nr_partido,nm_ue,sg_uf,vr_bem_candidato
FROM candidato can, bem_candidato bem
WHERE can.sq_candidato = bem.sq_candidato AND
vr_bem_candidato = (SELECT max(vr_bem_candidato)FROM bem_candidato)

3)
SELECT avg(vr_bem_candidato) AS média
FROM candidato can,bem_candidato bem 
WHERE can.sq_candidato = bem.sq_candidato AND
nm_candidato = 'JOSE LUIZ DATENA'

4)
SELECT sg_uf,COUNT(*)
FROM candidato can,cargo car
WHERE can.cd_cargo = car.cd_cargo AND
car.ds_cargo = 'VEREADOR'
GROUP BY sg_uf
ORDER BY can.sg_uf

5)
SELECT nm_ue,COUNT(*)
FROM candidato can, cargo car, genero gen
WHERE can.cd_cargo = car.cd_cargo AND
car.ds_cargo = 'VEREADOR' AND
gen.cd_genero = can.cd_genero AND
gen.ds_genero = 'FEMININO' AND
(nm_ue = 'RIO DE JANEIRO' OR nm_ue = 'SÃO PAULO' OR nm_ue = 'VITÓRIA' OR nm_ue = 'BELO HORIZONTE')
GROUP BY nm_ue

6)
SELECT COUNT(DISTINCT sq_coligacao)
FROM coligacao

7)
SELECT sg_partido,COUNT(*) as qtd
FROM candidato can, genero gen,cargo car, partido par
WHERE can.cd_genero = gen.cd_genero AND
gen.ds_genero = 'FEMININO' AND
can.cd_cargo = car.cd_cargo AND
car.ds_cargo = 'VEREADOR' AND
can.nm_ue = 'UBERLÂNDIA' AND
can.nr_partido = par.nr_partido
GROUP BY sg_partido
ORDER BY qtd

8)
SELECT sg_partido,COUNT(*)
FROM candidato can, genero gen, partido par
WHERE can.cd_genero = gen.cd_genero AND
gen.ds_genero = 'FEMININO' AND
can.nm_ue = 'SÃO PAULO' AND
can.nr_partido = par.nr_partido
GROUP BY sg_partido
HAVING COUNT(*) > 10

9)
SELECT sg_partido,ds_cor_raca,COUNT(*)
FROM candidato can, partido par, cor_raca cr
WHERE can.nm_ue = 'CUIABÁ' AND
can.nr_partido = par.nr_partido AND
can.cd_cor_raca = cr.cd_cor_raca
GROUP BY sg_partido, ds_cor_raca

10)
SELECT sg_partido,COUNT(*)
FROM candidato can, partido par
WHERE can.nm_ue = 'BELO HORIZONTE' AND
can.nr_partido = par.nr_partido
GROUP BY sg_partido
HAVING COUNT(*) >= ALL (SELECT COUNT(*) as qtd
	FROM candidato can, partido par
	WHERE can.nm_ue = 'BELO HORIZONTE' AND
	can.nr_partido = par.nr_partido
	GROUP BY sg_partido)

11)

Qual o partido político com a maior quantidade de candidatos na cidade de 'CACONDE'.

SELECT sg_partido,COUNT(*)
FROM candidato can, partido par
WHERE can.nm_ue = 'CACONDE' AND
can.nr_partido = par.nr_partido
GROUP BY sg_partido
HAVING COUNT(*) >= ALL (SELECT COUNT(*) as qtd
	FROM candidato can, partido par
	WHERE can.nm_ue = 'CACONDE' AND
	can.nr_partido = par.nr_partido
	GROUP BY sg_partido)

"MDB"	11
"PL"	11
"PODE"	11
"PSD"	11

---------------------

Quantas candidatas do gênero feminino estão concorrendo ao cargo de prefeito por partido 
político na cidade de 'RIBEIRÃO PRETO'. Devem ser exibidos no resultado a sigla do partido e a 
quantidade. 

SELECT sg_partido,COUNT(*) as qtd
FROM candidato can, genero gen,cargo car, partido par
WHERE can.cd_genero = gen.cd_genero AND
gen.ds_genero = 'FEMININO' AND
can.cd_cargo = car.cd_cargo AND
car.ds_cargo = 'PREFEITO' AND
can.nm_ue = 'RIBEIRÃO PRETO' AND
can.nr_partido = par.nr_partido
GROUP BY sg_partido
ORDER BY qtd

SEM RESULTADOS




















